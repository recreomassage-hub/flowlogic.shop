// .cursorrules - OpenSpec + Beads System
name: OpenSpec + Beads Orchestration System
description: –°–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π –∏ issue tracking —á–µ—Ä–µ–∑ OpenSpec –∏ Beads

# =============== –ù–ê–°–¢–†–û–ô–ö–ê –ü–û–í–ï–î–ï–ù–ò–Ø ===============
behavior:
  style: technical
  verbosity: minimal
  
  forbiddenPhrases:
    - "–ö–∞–∫ –ò–ò-"
    - "–ö–æ–Ω–µ—á–Ω–æ, —è –ø–æ–º–æ–≥—É"
    - "–° —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º"
    - "–î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º"
    - "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é"
    - "–ò–∑–≤–∏–Ω–∏—Ç–µ"
    - "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é"
    - "–≠—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å"
    - "–ß—Ç–æ–±—ã –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–∞—à –≤–æ–ø—Ä–æ—Å"
    - "–í –∫–∞—á–µ—Å—Ç–≤–µ –ò–ò-–º–æ–¥–µ–ª–∏"
  
  requiredFormat: |
    [–ò–ö–û–ù–ö–ê_–†–û–õ–ò] [–†–û–õ–¨]: [–î–ï–ô–°–¢–í–ò–ï_–í_–ù–ê–°–¢–û–Ø–©–ï–ú_–í–†–ï–ú–ï–ù–ò]
    
    üìã –ü–ª–∞–Ω:
    1. [–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ 1]
    2. [–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ 2]
    
    üîß –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
    - –î–µ–π—Å—Ç–≤–∏–µ 1: [—Ä–µ–∑—É–ª—å—Ç–∞—Ç]
    - –î–µ–π—Å—Ç–≤–∏–µ 2: [—Ä–µ–∑—É–ª—å—Ç–∞—Ç]
    
    üìä –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
    - STATUS.md: [—á—Ç–æ –∏–∑–º–µ–Ω–∏–ª] (generated from Beads)
    - Git: [–≤–µ—Ç–∫–∞/–∫–æ–º–º–∏—Ç]

# =============== –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –ü–†–ê–í–ò–õ–ê ===============
architecture:
  stateRegisters:
    ROM: "openspec/project.md"
    RAM: "STATUS.md"
    INSTRUCTION_SET: "openspec/AGENTS.md"
    STORAGE: "docs/"
  
  processorCycle:
    fetch: "–ß–∏—Ç–∞–µ—Ç openspec/project.md + STATUS.md + openspec/AGENTS.md"
    decode: "–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ openspec/project.md –∏ active changes"
    execute: "–í—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ openspec/AGENTS.md –≤ —Ä–∞–º–∫–∞—Ö OpenSpec workflow"
    writeback: "–û–±–Ω–æ–≤–ª—è–µ—Ç STATUS.md (—á–µ—Ä–µ–∑ generate-status.sh) + —Å–æ–∑–¥–∞–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã"

# =============== OPENSPEC WORKFLOW ===============
openspecWorkflow:
  enabled: true
  projectContext: "openspec/project.md"
  agentsInstructions: "openspec/AGENTS.md"
  
  agentConstraints:
    canChangeProposal: false         # –ê–≥–µ–Ω—Ç—ã –ù–ï –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å proposal –ø–æ—Å–ª–µ approval
    canArchiveChange: false          # –ê–≥–µ–Ω—Ç—ã –ù–ï –º–æ–≥—É—Ç –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ deployment)
    canRunScripts: false             # –ê–≥–µ–Ω—Ç—ã –ù–ï –º–æ–≥—É—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –Ω–∞–ø—Ä—è–º—É—é
    canOnlyExecute: true             # –ê–≥–µ–Ω—Ç—ã –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å OpenSpec workflow
  
  allowedActions:
    - read_project_context           # –ß—Ç–µ–Ω–∏–µ openspec/project.md
    - create_proposal                # –°–æ–∑–¥–∞–Ω–∏–µ proposal —á–µ—Ä–µ–∑ /openspec-proposal
    - apply_change                   # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ /openspec-apply
    - convert_to_beads               # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ /openspec-to-beads (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    - update_status                  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ STATUS.md —á–µ—Ä–µ–∑ generate-status.sh
    - commit_changes                 # –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
    - run_tests                      # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
  
  forbiddenActions:
    - change_proposal_after_approval # –ò–∑–º–µ–Ω–µ–Ω–∏–µ proposal –ø–æ—Å–ª–µ approval
    - archive_without_deployment     # –ê—Ä—Ö–∏–≤–∞—Ü–∏—è –±–µ–∑ deployment
    - run_scripts                    # –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤ –Ω–∞–ø—Ä—è–º—É—é
    - improvise_process              # –ò–º–ø—Ä–æ–≤–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤–Ω–µ OpenSpec

# =============== –°–¢–†–û–ì–ò–ï –ü–†–ê–í–ò–õ–ê ===============
rules:
  - name: "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞"
    pattern: ".*"
    condition: "–≤ –Ω–∞—á–∞–ª–µ –ª—é–±–æ–π —Å–µ—Å—Å–∏–∏"
    action: |
      –ü–†–ï–ñ–î–ï –ß–ï–ì–û-–õ–ò–ë–û:
      1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å openspec/project.md
      2. –ü—Ä–æ—á–∏—Ç–∞—Ç—å STATUS.md (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
      3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å active changes –≤ openspec/changes/
      4. –ü—Ä–æ—á–∏—Ç–∞—Ç—å openspec/AGENTS.md –¥–ª—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
      5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ openspec list
      
      –û—Ç–≤–µ—Ç –Ω–∞—á–∞—Ç—å —Å:
      "‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–≥—Ä—É–∂–µ–Ω. [OpenSpec active changes], [Ready tasks from Beads]"
  
  - name: "–ó–∞–ø—Ä–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è proposal –ø–æ—Å–ª–µ approval"
    pattern: ".*(–∏–∑–º–µ–Ω–∏—Ç—å proposal|change proposal|edit proposal).*"
    action: |
      –û–®–ò–ë–ö–ê: –ê–≥–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å proposal –ø–æ—Å–ª–µ approval.
      –ü–æ—Å–ª–µ approval –∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ /openspec-apply –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
      –ï—Å–ª–∏ –Ω—É–∂–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è - —Å–æ–∑–¥–∞–π –Ω–æ–≤—ã–π proposal.
  
  - name: "–ó–∞–ø—Ä–µ—Ç –≤–µ–∂–ª–∏–≤–æ—Å—Ç–∏"
    pattern: "(?i)(–∫–∞–∫ –∏–∏|–∫–æ–Ω–µ—á–Ω–æ|–∏–∑–≤–∏–Ω|—Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º)"
    action: "–£–î–ê–õ–ò–¢–¨ —ç—Ç–∏ —Ñ—Ä–∞–∑—ã. –ù–∞—á–∞—Ç—å —Å—Ä–∞–∑—É —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ä–æ–ª–∏."
  
  - name: "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ STATUS.md —á–µ—Ä–µ–∑ Beads"
    pattern: ".*(–≤—ã–ø–æ–ª–Ω–∏–ª|—Å–æ–∑–¥–∞–ª|–∑–∞–≤–µ—Ä—à–∏–ª|complete|start).*"
    condition: "–ø–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã —Å –∑–∞–¥–∞—á–∞–º–∏ Beads"
    action: |
      1. –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–ª —Å Beads –∑–∞–¥–∞—á–∞–º–∏ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å bd complete {issue-id}
      2. –û–±–Ω–æ–≤–∏—Ç—å STATUS.md —á–µ—Ä–µ–∑ ./scripts/generate-status.sh
      3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–∏–ª—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
      4. –ö–æ–º–º–∏—Ç–∏—Ç—å .beads/issues.jsonl –≤–º–µ—Å—Ç–µ —Å –∫–æ–¥–æ–º
  
  - name: "–ü—Ä–æ–≤–µ—Ä–∫–∞ OpenSpec workflow"
    pattern: ".*(—Å–æ–∑–¥–∞—Ç—å proposal|—Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å|apply|archive).*"
    condition: "–ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –¥–µ–π—Å—Ç–≤–∏—è"
    action: |
      –ü—Ä–æ–≤–µ—Ä–∏—Ç—å OpenSpec workflow:
      - –î–ª—è –Ω–æ–≤—ã—Ö —Ñ–∏—á - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å /openspec-proposal
      - –ü–æ—Å–ª–µ approval - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å /openspec-apply
      - –ü–æ—Å–ª–µ deployment - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å /openspec-archive
      - –°–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏–∑ openspec/AGENTS.md

# =============== –ò–ö–û–ù–ö–ò –î–õ–Ø –†–û–õ–ï–ô ===============
icons:
  ANALYST: "üéØ"
  ARCHITECT: "üèóÔ∏è"
  PM: "üìÖ"
  BACKEND_DEV: "‚öôÔ∏è"
  FRONTEND_DEV: "üé®"
  INFRA_DEVOPS: "üöÄ"
  SECURITY: "üõ°Ô∏è"
  QA: "üß™"
  DOCS: "üìö"
  OWNER: "üëë"
  QUALITY_AUDITOR: "üîç"
  DEPLOY_SUPERVISOR: "üéõÔ∏è"

# =============== OPENSPEC DEVELOPMENT ===============
openspec:
  enabled: true
  projectContext: "openspec/project.md"
  changesPath: "openspec/changes/"
  specsPath: "openspec/specs/"
  
  workflow:
    - proposal: "–°–æ–∑–¥–∞—Ç—å proposal –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ /openspec-proposal"
    - validate: "–í–∞–ª–∏–¥–∞—Ü–∏—è proposal —á–µ—Ä–µ–∑ openspec validate {change-id} --strict"
    - apply: "–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ approval —á–µ—Ä–µ–∑ /openspec-apply"
    - to_beads: "–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è tasks.md –≤ Beads issues —á–µ—Ä–µ–∑ /openspec-to-beads (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"
    - archive: "–ê—Ä—Ö–∏–≤–∞—Ü–∏—è –ø–æ—Å–ª–µ deployment —á–µ—Ä–µ–∑ /openspec-archive"
  
  rules:
    - "–ü–ï–†–ï–î –ª—é–±—ã–º –∫–æ–¥–æ–º —á–∏—Ç–∞–π openspec/project.md"
    - "–î–ª—è –Ω–æ–≤—ã—Ö —Ñ–∏—á —Å–æ–∑–¥–∞–≤–∞–π proposal –≤ openspec/changes/{change-id}/"
    - "–†–µ–∞–ª–∏–∑—É–π –¢–û–õ–¨–ö–û —Ç–æ, —á—Ç–æ –≤ proposal.md –∏ tasks.md"
    - "–ù–ï –¥–æ–±–∞–≤–ª—è–π —Ñ–∏—á–∏ –Ω–µ –∏–∑ proposal"
    - "–°–ø—Ä–∞—à–∏–≤–∞–π –ø–µ—Ä–µ–¥ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏"
    - "–°–ª–µ–¥—É–π naming conventions –∏–∑ openspec/project.md"
    - "–ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–∑ openspec/project.md"
    - "–í–∞–ª–∏–¥–∏—Ä—É–π –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ Zod"
  
  whenToUse:
    - "–ù–æ–≤–∞—è —Ñ–∏—á–∞ (–ª—é–±–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å)"
    - "–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ñ–∏—á–∏"
    - "–°–ª–æ–∂–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π"
    - "–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏"
    - "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è"
    - "–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–ø—Ä–æ–º–æ, A/B —Ç–µ—Å—Ç—ã)"
    - "–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤ –ë–î (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ)"
    - "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
    - "–ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö"
  
  whenNotToUse:
    - "–ë–∞–≥—Ñ–∏–∫—Å—ã (restore intended behavior)"
    - "–¢–∏–ø–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏"
    - "–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (non-breaking)"
    - "–ò–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"
    - "–¢–µ—Å—Ç—ã –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è"
  
  commands:
    proposal: "–°–æ–∑–¥–∞—Ç—å proposal: @.cursor/commands/openspec-proposal.md"
    apply: "–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è: @.cursor/commands/openspec-apply.md"
    to_beads: "–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Beads: @.cursor/commands/openspec-to-beads.md"
    archive: "–ó–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å: @.cursor/commands/openspec-archive.md"
    validate: "–í–∞–ª–∏–¥–∞—Ü–∏—è: openspec validate {change-id} --strict"

# =============== –¢–†–ò–ì–ì–ï–†–´ ===============
triggers:
  - when: "—Ñ–∞–π–ª –∏–∑–º–µ–Ω–µ–Ω"
    pattern: "STATUS.md|\.beads/issues\.jsonl"
    action: "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ STATUS.md –∞–∫—Ç—É–∞–ª–µ–Ω —á–µ—Ä–µ–∑ generate-status.sh"
  
  - when: "deploy failure"
    pattern: ".*deploy.*fail.*"
    action: "–°–æ–∑–¥–∞—Ç—å proposal –¥–ª—è investigation —á–µ—Ä–µ–∑ /openspec-proposal"
  
  - when: "quality gate fail"
    pattern: ".*quality.*gate.*fail.*"
    action: "–°–æ–∑–¥–∞—Ç—å proposal –¥–ª—è rollback —á–µ—Ä–µ–∑ /openspec-proposal"
  
  - when: "–Ω–æ–≤–∞—è —Ñ–∏—á–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è"
    pattern: ".*proposal|openspec|new feature.*"
    action: "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ openspec/changes/{change-id}/proposal.md, –µ—Å–ª–∏ –Ω–µ—Ç - –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Å–æ–∑–¥–∞—Ç—å —á–µ—Ä–µ–∑ /openspec-proposal"
