#!/bin/bash
# Aliases for Flow Logic project scripts
# 
# Installation:
#   Option 1 (recommended): Run ./install-aliases.sh
#   Option 2 (manual): Add to your .bashrc or .zshrc:
#     source "/path/to/project/.aliases"
#
# Usage in current session:
#   source .aliases

# Get project root directory (where this file is located)
PROJECT_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Issue Tracking - используем официальный Beads CLI напрямую
# Алиасы удалены - используйте команду `bd` напрямую
# Установка: npm install -g @beads/bd@latest

# Status Management
_status_gen() {
    "$PROJECT_ROOT/scripts/generate-status.sh" "$@"
}
_status_read() {
    cat "$PROJECT_ROOT/STATUS.md"
}
_status_view() {
    cat "$PROJECT_ROOT/STATUS.md"
}

# Deployment
_post_deploy() {
    "$PROJECT_ROOT/scripts/post_deploy.sh" "$@"
}
_smoke_tests() {
    "$PROJECT_ROOT/scripts/smoke_tests.sh" "$@"
}

# Legacy LLM-OS (for scenarios only)
_llmos_setup() {
    "$PROJECT_ROOT/setup_workflow.sh" "$@"
}
_llmos_launch() {
    "$PROJECT_ROOT/launch-llmos.sh" "$@"
}
_llmos_monitor() {
    "$PROJECT_ROOT/monitor.sh" "$@"
}
_llmos_step() {
    "$PROJECT_ROOT/step.sh" "$@"
}
_llmos_report() {
    "$PROJECT_ROOT/generate_report.sh" "$@"
}

# Feature Management (Legacy)
_feature_new() {
    "$PROJECT_ROOT/scripts/feature_new.sh" "$@"
}
_feature_impact() {
    "$PROJECT_ROOT/scripts/feature_impact.sh" "$@"
}
_feature_flag() {
    "$PROJECT_ROOT/scripts/feature_check_flag.sh" "$@"
}

# Scenario Management
_quality_gate() {
    "$PROJECT_ROOT/scripts/quality_gate.sh" "$@"
}
_rollback() {
    "$PROJECT_ROOT/scripts/rollback_stage.sh" "$@"
}
_incident_detect() {
    "$PROJECT_ROOT/scripts/incident_detector.sh" "$@"
}

# Utility Scripts
_setup_precommit() {
    "$PROJECT_ROOT/scripts/setup_pre_commit.sh" "$@"
}
_check_ssm() {
    "$PROJECT_ROOT/scripts/check_ssm_params.sh" "$@"
}
_setup_monitoring() {
    "$PROJECT_ROOT/scripts/setup_monitoring.sh" "$@"
}
_setup_iam() {
    "$PROJECT_ROOT/infra/iam/setup.sh" "$@"
}

# Quick shortcuts для работы с issues (используют прямую команду bd)
_issues() {
    cat "$PROJECT_ROOT/.beads/issues.jsonl"
}
_issues_active() {
    _issues | jq 'select(.status == "in_progress")'
}
_issues_done() {
    _issues | jq 'select(.status == "done")'
}

# Aliases (Beads алиасы удалены - используйте команду `bd` напрямую)

alias status-gen="_status_gen"
alias status-read="_status_read"
alias status-view="_status_view"

alias post-deploy="_post_deploy"
alias smoke-tests="_smoke_tests"

alias llmos-setup="_llmos_setup"
alias llmos-launch="_llmos_launch"
alias llmos-monitor="_llmos_monitor"
alias llmos-step="_llmos_step"
alias llmos-report="_llmos_report"

alias feature-new="_feature_new"
alias feature-impact="_feature_impact"
alias feature-flag="_feature_flag"

alias quality-gate="_quality_gate"
alias rollback="_rollback"
alias incident-detect="_incident_detect"

alias setup-precommit="_setup_precommit"
alias check-ssm="_check_ssm"
alias setup-monitoring="_setup_monitoring"
alias setup-iam="_setup_iam"

alias issues="_issues"
alias issues-active="_issues_active"
alias issues-done="_issues_done"

# Export PROJECT_ROOT for use in other scripts
export PROJECT_ROOT
